{% load static %}

<!DOCTYPE html>
<html lang="en" class="scroll-smooth" data-theme="corporate">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
          content="{% block meta_description %}DjangoStarter - 下一代Django快速开发框架{% endblock %}">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <meta name="theme-color" content="#1e40af" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#1e3a8a" media="(prefers-color-scheme: dark)">
    <title>{% block title %}{% endblock %} - DjangoStarter</title>
    <link rel="icon" href="{% static 'img/favicon.ico' %}" type="image/x-icon">

    <link rel="stylesheet" href="{% static 'css/tailwind.prod.css' %}">
    {% block extra_css %}
        {# Override this in templates to add extra stylesheets #}
    {% endblock %}

    <link rel="stylesheet" href="{% static 'lib/font-awesome/css/all.min.css' %}">

    <script src="{% static 'lib/htmx/htmx.min.js' %}"></script>
    <script src="{% static 'lib/alpinejs/cdn.min.js' %}" defer></script>
    <script>
        // HTMX CSRF Configuration
        // Add CSRF token to all HTMX requests
        document.addEventListener('htmx:configRequest', (event) => {
            const csrfToken = document.querySelector('meta[name="csrf-token"]')?.content;
            if (csrfToken) {
                event.detail.headers['X-CSRFToken'] = csrfToken;
            }
        });
    </script>
    {% block head %}{% endblock %}
</head>

<body class="bg-base-100 text-base-content">

<div class="drawer {% block drawer_class %}lg:drawer-open{% endblock %}">
    <input id="app-drawer" type="checkbox" class="drawer-toggle" />
    
    <div class="drawer-content flex flex-col min-h-screen">
        <!-- Navbar -->
        {% include '_components/navbar.html' %}
        <!-- End of Navbar -->

        <main class="container mx-auto p-4 flex-grow">
            {% block alert %}
                {% if messages %}
                    {% for message in messages %}
                        {% if message.tags != 'console' %}
                            {% include '_components/alert.html' %}
                        {% endif %}
                    {% endfor %}
                {% endif %}
            {% endblock %}
            {% block content %}
            {% endblock content %}
        </main>

        {% include '_components/footer.html' %}
    </div>

    <div class="drawer-side z-40">
        <label for="app-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
        <aside class="menu p-4 w-80 min-h-full bg-base-200 text-base-content border-r border-base-300">
            <!-- Sidebar Content -->
             <div class="mb-4 flex items-center gap-2 px-2">
                <i class="fa-brands fa-python text-primary text-2xl"></i>
                <span class="text-xl font-bold">DjangoStarter</span>
             </div>
             <ul class="menu menu-lg">
                <li><a href="{% url 'djs_guide:index' %}"><i class="fa-solid fa-home"></i> Home</a></li>
                {% block sidebar_menu %}{% endblock %}
             </ul>
        </aside>
    </div>
</div>

<script src="{% static 'js/site.js' %}"></script>
{% block script %}{% endblock %}
{% block extra_js %}{% endblock %}
</body>

</html>
